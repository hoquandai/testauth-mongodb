{"ast":null,"code":"import { Assertions } from \"mongodb-stitch-core-sdk\";\nimport { operationTypeFromRemote } from \"../OperationType\";\nimport RemoteInsertManyResult from \"../RemoteInsertManyResult\";\nvar RemoteInsertManyResultFields;\n\n(function (RemoteInsertManyResultFields) {\n  RemoteInsertManyResultFields[\"InsertedIds\"] = \"insertedIds\";\n})(RemoteInsertManyResultFields || (RemoteInsertManyResultFields = {}));\n\nvar RemoteInsertOneResultFields;\n\n(function (RemoteInsertOneResultFields) {\n  RemoteInsertOneResultFields[\"InsertedId\"] = \"insertedId\";\n})(RemoteInsertOneResultFields || (RemoteInsertOneResultFields = {}));\n\nvar RemoteUpdateResultFields;\n\n(function (RemoteUpdateResultFields) {\n  RemoteUpdateResultFields[\"MatchedCount\"] = \"matchedCount\";\n  RemoteUpdateResultFields[\"ModifiedCount\"] = \"modifiedCount\";\n  RemoteUpdateResultFields[\"UpsertedId\"] = \"upsertedId\";\n})(RemoteUpdateResultFields || (RemoteUpdateResultFields = {}));\n\nvar RemoteDeleteResultFields;\n\n(function (RemoteDeleteResultFields) {\n  RemoteDeleteResultFields[\"DeletedCount\"] = \"deletedCount\";\n})(RemoteDeleteResultFields || (RemoteDeleteResultFields = {}));\n\nvar ChangeEventFields;\n\n(function (ChangeEventFields) {\n  ChangeEventFields[\"Id\"] = \"_id\";\n  ChangeEventFields[\"OperationType\"] = \"operationType\";\n  ChangeEventFields[\"FullDocument\"] = \"fullDocument\";\n  ChangeEventFields[\"DocumentKey\"] = \"documentKey\";\n  ChangeEventFields[\"Namespace\"] = \"ns\";\n  ChangeEventFields[\"NamespaceDb\"] = \"db\";\n  ChangeEventFields[\"NamespaceColl\"] = \"coll\";\n  ChangeEventFields[\"UpdateDescription\"] = \"updateDescription\";\n  ChangeEventFields[\"UpdateDescriptionUpdatedFields\"] = \"updatedFields\";\n  ChangeEventFields[\"UpdateDescriptionRemovedFields\"] = \"removedFields\";\n})(ChangeEventFields || (ChangeEventFields = {}));\n\nvar RemoteInsertManyResultDecoder = function () {\n  function RemoteInsertManyResultDecoder() {}\n\n  RemoteInsertManyResultDecoder.prototype.decode = function (from) {\n    return new RemoteInsertManyResult(from[RemoteInsertManyResultFields.InsertedIds]);\n  };\n\n  return RemoteInsertManyResultDecoder;\n}();\n\nvar RemoteInsertOneResultDecoder = function () {\n  function RemoteInsertOneResultDecoder() {}\n\n  RemoteInsertOneResultDecoder.prototype.decode = function (from) {\n    return {\n      insertedId: from[RemoteInsertOneResultFields.InsertedId]\n    };\n  };\n\n  return RemoteInsertOneResultDecoder;\n}();\n\nvar RemoteUpdateResultDecoder = function () {\n  function RemoteUpdateResultDecoder() {}\n\n  RemoteUpdateResultDecoder.prototype.decode = function (from) {\n    return {\n      matchedCount: from[RemoteUpdateResultFields.MatchedCount],\n      modifiedCount: from[RemoteUpdateResultFields.ModifiedCount],\n      upsertedId: from[RemoteUpdateResultFields.UpsertedId]\n    };\n  };\n\n  return RemoteUpdateResultDecoder;\n}();\n\nvar RemoteDeleteResultDecoder = function () {\n  function RemoteDeleteResultDecoder() {}\n\n  RemoteDeleteResultDecoder.prototype.decode = function (from) {\n    return {\n      deletedCount: from[RemoteDeleteResultFields.DeletedCount]\n    };\n  };\n\n  return RemoteDeleteResultDecoder;\n}();\n\nvar ChangeEventDecoder = function () {\n  function ChangeEventDecoder(decoder) {\n    this.decoder = decoder;\n  }\n\n  ChangeEventDecoder.prototype.decode = function (from) {\n    Assertions.keyPresent(ChangeEventFields.Id, from);\n    Assertions.keyPresent(ChangeEventFields.OperationType, from);\n    Assertions.keyPresent(ChangeEventFields.Namespace, from);\n    Assertions.keyPresent(ChangeEventFields.DocumentKey, from);\n    var nsDoc = from[ChangeEventFields.Namespace];\n    var updateDescription;\n\n    if (ChangeEventFields.UpdateDescription in from) {\n      var updateDescDoc = from[ChangeEventFields.UpdateDescription];\n      Assertions.keyPresent(ChangeEventFields.UpdateDescriptionUpdatedFields, updateDescDoc);\n      Assertions.keyPresent(ChangeEventFields.UpdateDescriptionRemovedFields, updateDescDoc);\n      updateDescription = {\n        removedFields: updateDescDoc[ChangeEventFields.UpdateDescriptionRemovedFields],\n        updatedFields: updateDescDoc[ChangeEventFields.UpdateDescriptionUpdatedFields]\n      };\n    } else {\n      updateDescription = undefined;\n    }\n\n    var fullDocument;\n\n    if (ChangeEventFields.FullDocument in from) {\n      fullDocument = from[ChangeEventFields.FullDocument];\n\n      if (this.decoder) {\n        fullDocument = this.decoder.decode(fullDocument);\n      }\n    } else {\n      fullDocument = undefined;\n    }\n\n    return {\n      documentKey: from[ChangeEventFields.DocumentKey],\n      fullDocument: fullDocument,\n      id: from[ChangeEventFields.Id],\n      namespace: {\n        collection: nsDoc[ChangeEventFields.NamespaceColl],\n        database: nsDoc[ChangeEventFields.NamespaceDb]\n      },\n      operationType: operationTypeFromRemote(from[ChangeEventFields.OperationType]),\n      updateDescription: updateDescription\n    };\n  };\n\n  return ChangeEventDecoder;\n}();\n\nvar ResultDecoders = function () {\n  function ResultDecoders() {}\n\n  ResultDecoders.remoteInsertManyResultDecoder = new RemoteInsertManyResultDecoder();\n  ResultDecoders.remoteInsertOneResultDecoder = new RemoteInsertOneResultDecoder();\n  ResultDecoders.remoteUpdateResultDecoder = new RemoteUpdateResultDecoder();\n  ResultDecoders.remoteDeleteResultDecoder = new RemoteDeleteResultDecoder();\n  ResultDecoders.ChangeEventDecoder = ChangeEventDecoder;\n  return ResultDecoders;\n}();\n\nexport default ResultDecoders;","map":{"version":3,"sources":["../../../src/internal/ResultDecoders.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import { Assertions } from \"mongodb-stitch-core-sdk\";\nimport { operationTypeFromRemote } from \"../OperationType\";\nimport RemoteInsertManyResult from \"../RemoteInsertManyResult\";\nvar RemoteInsertManyResultFields;\n(function (RemoteInsertManyResultFields) {\n    RemoteInsertManyResultFields[\"InsertedIds\"] = \"insertedIds\";\n})(RemoteInsertManyResultFields || (RemoteInsertManyResultFields = {}));\nvar RemoteInsertOneResultFields;\n(function (RemoteInsertOneResultFields) {\n    RemoteInsertOneResultFields[\"InsertedId\"] = \"insertedId\";\n})(RemoteInsertOneResultFields || (RemoteInsertOneResultFields = {}));\nvar RemoteUpdateResultFields;\n(function (RemoteUpdateResultFields) {\n    RemoteUpdateResultFields[\"MatchedCount\"] = \"matchedCount\";\n    RemoteUpdateResultFields[\"ModifiedCount\"] = \"modifiedCount\";\n    RemoteUpdateResultFields[\"UpsertedId\"] = \"upsertedId\";\n})(RemoteUpdateResultFields || (RemoteUpdateResultFields = {}));\nvar RemoteDeleteResultFields;\n(function (RemoteDeleteResultFields) {\n    RemoteDeleteResultFields[\"DeletedCount\"] = \"deletedCount\";\n})(RemoteDeleteResultFields || (RemoteDeleteResultFields = {}));\nvar ChangeEventFields;\n(function (ChangeEventFields) {\n    ChangeEventFields[\"Id\"] = \"_id\";\n    ChangeEventFields[\"OperationType\"] = \"operationType\";\n    ChangeEventFields[\"FullDocument\"] = \"fullDocument\";\n    ChangeEventFields[\"DocumentKey\"] = \"documentKey\";\n    ChangeEventFields[\"Namespace\"] = \"ns\";\n    ChangeEventFields[\"NamespaceDb\"] = \"db\";\n    ChangeEventFields[\"NamespaceColl\"] = \"coll\";\n    ChangeEventFields[\"UpdateDescription\"] = \"updateDescription\";\n    ChangeEventFields[\"UpdateDescriptionUpdatedFields\"] = \"updatedFields\";\n    ChangeEventFields[\"UpdateDescriptionRemovedFields\"] = \"removedFields\";\n})(ChangeEventFields || (ChangeEventFields = {}));\nvar RemoteInsertManyResultDecoder = (function () {\n    function RemoteInsertManyResultDecoder() {\n    }\n    RemoteInsertManyResultDecoder.prototype.decode = function (from) {\n        return new RemoteInsertManyResult(from[RemoteInsertManyResultFields.InsertedIds]);\n    };\n    return RemoteInsertManyResultDecoder;\n}());\nvar RemoteInsertOneResultDecoder = (function () {\n    function RemoteInsertOneResultDecoder() {\n    }\n    RemoteInsertOneResultDecoder.prototype.decode = function (from) {\n        return {\n            insertedId: from[RemoteInsertOneResultFields.InsertedId]\n        };\n    };\n    return RemoteInsertOneResultDecoder;\n}());\nvar RemoteUpdateResultDecoder = (function () {\n    function RemoteUpdateResultDecoder() {\n    }\n    RemoteUpdateResultDecoder.prototype.decode = function (from) {\n        return {\n            matchedCount: from[RemoteUpdateResultFields.MatchedCount],\n            modifiedCount: from[RemoteUpdateResultFields.ModifiedCount],\n            upsertedId: from[RemoteUpdateResultFields.UpsertedId]\n        };\n    };\n    return RemoteUpdateResultDecoder;\n}());\nvar RemoteDeleteResultDecoder = (function () {\n    function RemoteDeleteResultDecoder() {\n    }\n    RemoteDeleteResultDecoder.prototype.decode = function (from) {\n        return {\n            deletedCount: from[RemoteDeleteResultFields.DeletedCount]\n        };\n    };\n    return RemoteDeleteResultDecoder;\n}());\nvar ChangeEventDecoder = (function () {\n    function ChangeEventDecoder(decoder) {\n        this.decoder = decoder;\n    }\n    ChangeEventDecoder.prototype.decode = function (from) {\n        Assertions.keyPresent(ChangeEventFields.Id, from);\n        Assertions.keyPresent(ChangeEventFields.OperationType, from);\n        Assertions.keyPresent(ChangeEventFields.Namespace, from);\n        Assertions.keyPresent(ChangeEventFields.DocumentKey, from);\n        var nsDoc = from[ChangeEventFields.Namespace];\n        var updateDescription;\n        if (ChangeEventFields.UpdateDescription in from) {\n            var updateDescDoc = from[ChangeEventFields.UpdateDescription];\n            Assertions.keyPresent(ChangeEventFields.UpdateDescriptionUpdatedFields, updateDescDoc);\n            Assertions.keyPresent(ChangeEventFields.UpdateDescriptionRemovedFields, updateDescDoc);\n            updateDescription = {\n                removedFields: updateDescDoc[ChangeEventFields.UpdateDescriptionRemovedFields],\n                updatedFields: updateDescDoc[ChangeEventFields.UpdateDescriptionUpdatedFields],\n            };\n        }\n        else {\n            updateDescription = undefined;\n        }\n        var fullDocument;\n        if (ChangeEventFields.FullDocument in from) {\n            fullDocument = from[ChangeEventFields.FullDocument];\n            if (this.decoder) {\n                fullDocument = this.decoder.decode(fullDocument);\n            }\n        }\n        else {\n            fullDocument = undefined;\n        }\n        return {\n            documentKey: from[ChangeEventFields.DocumentKey],\n            fullDocument: fullDocument,\n            id: from[ChangeEventFields.Id],\n            namespace: {\n                collection: nsDoc[ChangeEventFields.NamespaceColl],\n                database: nsDoc[ChangeEventFields.NamespaceDb]\n            },\n            operationType: operationTypeFromRemote(from[ChangeEventFields.OperationType]),\n            updateDescription: updateDescription\n        };\n    };\n    return ChangeEventDecoder;\n}());\nvar ResultDecoders = (function () {\n    function ResultDecoders() {\n    }\n    ResultDecoders.remoteInsertManyResultDecoder = new RemoteInsertManyResultDecoder();\n    ResultDecoders.remoteInsertOneResultDecoder = new RemoteInsertOneResultDecoder();\n    ResultDecoders.remoteUpdateResultDecoder = new RemoteUpdateResultDecoder();\n    ResultDecoders.remoteDeleteResultDecoder = new RemoteDeleteResultDecoder();\n    ResultDecoders.ChangeEventDecoder = ChangeEventDecoder;\n    return ResultDecoders;\n}());\nexport default ResultDecoders;\n//# sourceMappingURL=ResultDecoders.js.map"]},"metadata":{},"sourceType":"module"}